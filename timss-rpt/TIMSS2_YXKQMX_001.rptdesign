<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.3.2.v20140211-1400 Build &lt;4.3.2.v20140225-1404></property>
    <property name="units">in</property>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="workdate" id="1721">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="deptname" id="1722">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="year" id="1865">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="concealValue">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="month" id="1866">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="siteId" id="1869">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="deptId" id="1870">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="userId" id="1871">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data Source" id="1720">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">oracle.jdbc.OracleDriver</property>
            <property name="odaURL">jdbc:oracle:thin:@10.0.17.154:1521:itceam</property>
            <property name="odaUser">timss2dev</property>
            <encrypted-property name="odaPassword" encryptionID="base64">YWJj</encrypted-property>
            <property name="odaJndiName">java:comp/env/jdbc/timss2dev</property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="DS_Deptname" id="1723">
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">2</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">3</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">4</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">5</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_6</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">6</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_7</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">7</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_8</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">8</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_9</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">9</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_10</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">10</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">TITLE</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">TITLE</property>
                    <property name="nativeName">TITLE</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[--SQL2
select wm_concat(distinct deptname) as title
from ATD_WORKSTATUS
where isopr='Y' and siteid = ?
and(nvl(?,'-')='-' or nvl(?,'-')<>'-' and deptName like '%'||?||'%')
and (nvl(?,'-')='-' or nvl(?,'-')<>'-' and userId like '%'||?||'%')
and (nvl(?,'-')='-' or nvl(?,'-')<>'-' and deptId in (select distinct org_code from sec_organization o start with o.org_code =? connect by prior org_code = o.parent_code))

--【解析】
--1、给表头左侧获取的部门名称。
--2、查询是模糊查询。在birt里面貌似不可使用like '?' 所以这里使用了instr。]]></xml-property>
            <property name="rowFetchSize">1</property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="DS_Workdate" id="1724">
            <property name="nullsOrdering">nulls lowest</property>
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_7</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">year</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">2</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="paramName">month</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">3</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">4</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_9</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">5</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_10</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">6</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_8</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">7</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="paramName">year</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">8</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_6</property>
                    <property name="paramName">month</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">9</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">10</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_11</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">11</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_12</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">12</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_13</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">13</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_14</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">14</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_15</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">15</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_16</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">16</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_17</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">17</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_18</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">18</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">DEPTID</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">USERID</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">USERNAME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">WORKDATETIME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">D</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">WORKDATE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">SJ</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">ISOPR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">DHZ</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">STATUSVAL</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">DEPTID</property>
                    <property name="nativeName">DEPTID</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">USERID</property>
                    <property name="nativeName">USERID</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">USERNAME</property>
                    <property name="nativeName">USERNAME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">WORKDATETIME</property>
                    <property name="nativeName">WORKDATETIME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">D</property>
                    <property name="nativeName">D</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">WORKDATE</property>
                    <property name="nativeName">WORKDATE</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">SJ</property>
                    <property name="nativeName">SJ</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">ISOPR</property>
                    <property name="nativeName">ISOPR</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">DHZ</property>
                    <property name="nativeName">DHZ</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">STATUSVAL</property>
                    <property name="nativeName">STATUSVAL</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[SELECT 
partschedule.deptid,
partschedule.userid,
trim(partschedule.username) as username,
partschedule.workdatetime,
partschedule.D,
partschedule.workdate,
partschedule.sj,
partschedule.isopr,
decode(partschedule.D,'1','日','2','一','3','二','4','三','5','四','6','五','7','六') as DHZ,
case when partschedule.STATUS = '-1' then '休' 
     when partschedule.STATUS2 = '异' then partschedule.STATUS4 
     when partschedule.STATUS2 = '请' then partschedule.STATUS3 
     else partschedule.STATUS2 end as statusVal

FROM
(
SELECT deptid,userid,/*用户ID*/username,/*用户姓名*/workdate as workdatetime,
to_char(to_date(workdate,'yyyy-MM-dd'),'D') as D,substr( workdate, 9, 2) as workdate, /*天*/'上班' as sj,
decode(status,0,'-1','0') as status,--上午上班打卡情况
nvl(B1.ATTRIBUTE1,'') as status2,B2.ATTRIBUTE1 as status3,B3.ATTRIBUTE1 as status4,isopr
FROM ATD_WORKSTATUS A
LEFT JOIN B_ENUM B1 ON B1.ECAT_CODE = 'ATD_WORK_STATUS_TYPE' AND B1.ENUM_CODE = A.mornStartCheckTYPE 
LEFT JOIN B_ENUM B2 ON B2.ECAT_CODE = 'ATD_LEI_CATEGORY' AND B2.ENUM_CODE = A.mornStartCheck AND B2.SITEID = A.SITEID
LEFT JOIN B_ENUM B3 ON B3.ECAT_CODE = 'ATD_AB_CATEGORY' AND B3.ENUM_CODE = A.mornStartCheck AND B3.SITEID = A.SITEID
WHERE A.siteId = ?
AND substr( workdate, 0, 4) = ?
AND substr( workdate, 6, 2) = ?
and(nvl(?,'-')='-' or nvl(?,'-')<>'-' and deptName like '%'||?||'%')
and not exists(
select 1 from atd_exempt e
where (e.type='user_id' and e.relationid = userid) or (e.type='org_code' and e.relationid = deptid)
)

union 
SELECT deptid,userid,/*用户ID*/username,/*用户姓名*/workdate as workdatetime,
to_char(to_date(workdate,'yyyy-MM-dd'),'D') as D,substr( workdate, 9, 2) as workdate, /*天*/'下班' as sj,
decode(status,0,'-1','0') as status,--上午下班打卡情况
nvl(B1.ATTRIBUTE1,'') as status2,B2.ATTRIBUTE1 as status3,B3.ATTRIBUTE1 as status4,isopr
FROM ATD_WORKSTATUS A 
LEFT JOIN B_ENUM B1 ON B1.ECAT_CODE = 'ATD_WORK_STATUS_TYPE' AND B1.ENUM_CODE = A.mornEndCheckTYPE 
LEFT JOIN B_ENUM B2 ON B2.ECAT_CODE = 'ATD_LEI_CATEGORY' AND B2.ENUM_CODE = A.mornEndCheck AND B2.SITEID = A.SITEID
LEFT JOIN B_ENUM B3 ON B3.ECAT_CODE = 'ATD_AB_CATEGORY' AND B3.ENUM_CODE = A.mornEndCheck AND B3.SITEID = A.SITEID
WHERE A.siteId = ?
AND substr( workdate, 0, 4) = ?
AND substr( workdate, 6, 2) = ?
and(nvl(?,'-')='-' or nvl(?,'-')<>'-' and deptName like '%'||?||'%')
and not exists(
select 1 from atd_exempt e
where (e.type='user_id' and e.relationid = userid) or (e.type='org_code' and e.relationid = deptid)
)

) partschedule
where partschedule.isopr='Y'
and (nvl(?,'-')='-' or nvl(?,'-')<>'-' and partschedule.userId like '%'||?||'%')
and (nvl(?,'-')='-' or nvl(?,'-')<>'-' and partschedule.deptId  in (select distinct org_code from sec_organization o start with o.org_code =? connect by prior org_code = o.parent_code))
order by partschedule.userid asc,partschedule.sj]]></xml-property>
            <property name="rowFetchSize">1</property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Ds_Site" id="1868">
            <property name="nullsOrdering">nulls lowest</property>
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">siteId</property>
                    <property name="dataType">string</property>
                    <property name="position">1</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">NAME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">SHORT_NAME</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">NAME</property>
                    <property name="nativeName">NAME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">SHORT_NAME</property>
                    <property name="nativeName">SHORT_NAME</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select a.name,a.short_name from sec_organization a, sec_site_organization b
where a.org_code = b.org_code
and b.site_id=?]]></xml-property>
            <property name="rowFetchSize">1</property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="DS_Count" id="1725">
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_4</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">year</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">2</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="paramName">month</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">3</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">4</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">5</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_6</property>
                    <property name="paramName">deptname</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">6</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_7</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">7</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_8</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">8</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_9</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">9</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_10</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">10</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_11</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">11</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_12</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">12</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">COUNT(DISTINCTUSERID)</property>
                        <property name="dataType">decimal</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">COUNT(DISTINCTUSERID)</property>
                    <property name="nativeName">COUNT(DISTINCTUSERID)</property>
                    <property name="dataType">decimal</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[
--SQL3
SELECT count(distinct userid)
FROM ATD_WORKSTATUS A 
LEFT JOIN B_ENUM B1 ON B1.ECAT_CODE = 'ATD_WORK_STATUS_TYPE' AND B1.ENUM_CODE = A.noonEndChecktype 
LEFT JOIN B_ENUM B2 ON B2.ECAT_CODE = 'ATD_LEI_CATEGORY' AND B2.ENUM_CODE = A.noonEndCheck AND B2.SITEID = A.SITEID
LEFT JOIN B_ENUM B3 ON B3.ECAT_CODE = 'ATD_AB_CATEGORY' AND B3.ENUM_CODE = A.noonEndCheck AND B3.SITEID = A.SITEID
WHERE A.siteId = ?
AND A.isopr='Y'
AND substr( workdate, 0, 4) = ?
AND substr( workdate, 6, 2) = ?
and(nvl(?,'-')='-' or nvl(?,'-')<>'-' and deptName like '%'||?||'%')
and not exists(
select 1 from atd_exempt e
where (e.type='user_id' and e.relationid = userid) or (e.type='org_code' and e.relationid = deptid)
)
and (nvl(?,'-')='-' or nvl(?,'-')<>'-' and A.userId like '%'||?||'%')
and (nvl(?,'-')='-' or nvl(?,'-')<>'-' and A.deptId  in (select distinct org_code from sec_organization o start with o.org_code =? connect by prior org_code = o.parent_code))

--【解析】
--1、给表头右侧获取人数，实际是SQL1中取的片段。
]]></xml-property>
            <property name="rowFetchSize">1</property>
        </oda-data-set>
    </data-sets>
    <cubes>
        <tabular-cube name="Data Cube" id="1808">
            <property name="dimensions">
                <tabular-dimension name="Group" id="1811">
                    <property name="defaultHierarchy">NewTabularHierarchy</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy" id="1812">
                            <property name="levels">
                                <tabular-level name="USERNAME" id="1813">
                                    <property name="dataType">string</property>
                                    <property name="levelType">dynamic</property>
                                    <property name="columnName">USERNAME</property>
                                </tabular-level>
                                <tabular-level name="SJ" id="1814">
                                    <property name="dataType">string</property>
                                    <property name="levelType">dynamic</property>
                                    <property name="columnName">SJ</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group1" id="1826">
                    <property name="defaultHierarchy">NewTabularHierarchy1</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy1" id="1827">
                            <property name="levels">
                                <tabular-level name="WORKDATE" id="1828">
                                    <property name="dataType">string</property>
                                    <property name="levelType">dynamic</property>
                                    <property name="columnName">WORKDATE</property>
                                </tabular-level>
                                <tabular-level name="DHZ" id="1829">
                                    <property name="dataType">string</property>
                                    <property name="levelType">dynamic</property>
                                    <property name="columnName">DHZ</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
            </property>
            <property name="measureGroups">
                <tabular-measure-group name="Summary Field" id="1830">
                    <property name="measures">
                        <tabular-measure name="STATUSVAL" id="1831">
                            <property name="function">first</property>
                            <property name="isCalculated">false</property>
                            <expression name="measureExpression" type="javascript">dataSetRow["STATUSVAL"]</expression>
                            <property name="dataType">string</property>
                            <property name="isVisible">true</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
            </property>
            <property name="dataSet">DS_Workdate</property>
        </tabular-cube>
    </cubes>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">a4</property>
            <property name="orientation">landscape</property>
        </simple-master-page>
    </page-setup>
    <body>
        <grid id="629">
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression" type="javascript">params["year"].value</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_1</property>
                    <expression name="expression" type="javascript">params["month"].value</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
            </list-property>
            <column id="884">
                <property name="width">20px</property>
            </column>
            <column id="630"/>
            <row id="634">
                <property name="height">0.719in</property>
                <cell id="869"/>
                <cell id="635">
                    <property name="colSpan">1</property>
                    <property name="rowSpan">1</property>
                    <grid id="1203">
                        <column id="1204">
                            <property name="width">90px</property>
                        </column>
                        <column id="1205">
                            <property name="width">9.948in</property>
                        </column>
                        <row id="1206">
                            <cell id="1207">
                                <image id="1209">
                                    <property name="height">0.4266666666666667in</property>
                                    <property name="width">0.8533333333333334in</property>
                                    <property name="source">file</property>
                                    <expression name="uri" type="constant">logo2.jpg</expression>
                                </image>
                            </cell>
                            <cell id="1208">
                                <data id="1867">
                                    <property name="backgroundAttachment">scroll</property>
                                    <property name="backgroundPositionX">0%</property>
                                    <property name="backgroundPositionY">0%</property>
                                    <property name="backgroundRepeat">repeat</property>
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontSize">14pt</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="fontStyle">normal</property>
                                    <property name="fontVariant">normal</property>
                                    <property name="color">black</property>
                                    <property name="textLineThrough">none</property>
                                    <property name="textOverline">none</property>
                                    <property name="textUnderline">none</property>
                                    <property name="borderBottomColor">black</property>
                                    <property name="borderBottomStyle">none</property>
                                    <property name="borderBottomWidth">medium</property>
                                    <property name="borderLeftColor">black</property>
                                    <property name="borderLeftStyle">none</property>
                                    <property name="borderLeftWidth">medium</property>
                                    <property name="borderRightColor">black</property>
                                    <property name="borderRightStyle">none</property>
                                    <property name="borderRightWidth">medium</property>
                                    <property name="borderTopColor">black</property>
                                    <property name="borderTopStyle">none</property>
                                    <property name="borderTopWidth">medium</property>
                                    <property name="marginTop">0pt</property>
                                    <property name="marginLeft">0pt</property>
                                    <property name="marginBottom">0pt</property>
                                    <property name="marginRight">0pt</property>
                                    <property name="paddingTop">1pt</property>
                                    <property name="paddingLeft">1pt</property>
                                    <property name="paddingBottom">1pt</property>
                                    <property name="paddingRight">1pt</property>
                                    <property name="textAlign">center</property>
                                    <property name="letterSpacing">normal</property>
                                    <property name="lineHeight">normal</property>
                                    <property name="orphans">2</property>
                                    <property name="textTransform">none</property>
                                    <property name="whiteSpace">normal</property>
                                    <property name="widows">2</property>
                                    <property name="wordSpacing">normal</property>
                                    <property name="display">block</property>
                                    <property name="pageBreakAfter">auto</property>
                                    <property name="pageBreakBefore">auto</property>
                                    <property name="pageBreakInside">auto</property>
                                    <property name="showIfBlank">false</property>
                                    <property name="canShrink">false</property>
                                    <property name="overflow">hidden</property>
                                    <property name="dataSet">Ds_Site</property>
                                    <list-property name="boundDataColumns">
                                        <structure>
                                            <property name="name">NAME</property>
                                            <text-property name="displayName">NAME</text-property>
                                            <expression name="expression" type="javascript">dataSetRow["NAME"]</expression>
                                            <property name="dataType">string</property>
                                        </structure>
                                        <structure>
                                            <property name="name">SHORT_NAME</property>
                                            <text-property name="displayName">SHORT_NAME</text-property>
                                            <expression name="expression" type="javascript">dataSetRow["SHORT_NAME"]</expression>
                                            <property name="dataType">string</property>
                                        </structure>
                                        <structure>
                                            <property name="name">Column Binding</property>
                                            <expression name="expression" type="javascript">row["NAME"]+"员工考勤表（明细）"</expression>
                                            <property name="dataType">string</property>
                                            <property name="allowExport">true</property>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">Column Binding</property>
                                </data>
                            </cell>
                        </row>
                    </grid>
                </cell>
            </row>
            <row id="1863">
                <cell id="1864">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <grid id="472">
                        <property name="borderBottomStyle">none</property>
                        <property name="borderLeftStyle">none</property>
                        <property name="borderRightStyle">none</property>
                        <property name="borderTopStyle">none</property>
                        <property name="width">11.0625in</property>
                        <column id="473">
                            <property name="width">100px</property>
                        </column>
                        <column id="474">
                            <property name="width">2.5208333333333335in</property>
                        </column>
                        <column id="475">
                            <property name="width">0.8020833333333334in</property>
                        </column>
                        <column id="476">
                            <property name="width">0.375in</property>
                        </column>
                        <column id="477">
                            <property name="width">0.5625in</property>
                        </column>
                        <column id="478">
                            <property name="width">0.2916666666666667in</property>
                        </column>
                        <column id="479">
                            <property name="width">1.3020833333333333in</property>
                        </column>
                        <column id="480">
                            <property name="width">150px</property>
                        </column>
                        <column id="481">
                            <property name="width">60px</property>
                        </column>
                        <column id="482">
                            <property name="width">70px</property>
                        </column>
                        <column id="483">
                            <property name="width">60px</property>
                        </column>
                        <column id="484">
                            <property name="width">60px</property>
                        </column>
                        <row id="485">
                            <cell id="486">
                                <label id="498">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text">部门名称：</text-property>
                                </label>
                            </cell>
                            <cell id="487">
                                <property name="fontFamily">"宋体"</property>
                                <data id="1853">
                                    <property name="textAlign">left</property>
                                    <property name="dataSet">DS_Deptname</property>
                                    <list-property name="boundDataColumns">
                                        <structure>
                                            <property name="name">TITLE</property>
                                            <text-property name="displayName">TITLE</text-property>
                                            <expression name="expression" type="javascript">dataSetRow["TITLE"]</expression>
                                            <property name="dataType">string</property>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">TITLE</property>
                                </data>
                            </cell>
                            <cell id="488">
                                <label id="499">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text">（</text-property>
                                </label>
                            </cell>
                            <cell id="489">
                                <data id="1861">
                                    <property name="backgroundAttachment">scroll</property>
                                    <property name="backgroundPositionX">0%</property>
                                    <property name="backgroundPositionY">0%</property>
                                    <property name="backgroundRepeat">repeat</property>
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontSize">10pt</property>
                                    <property name="fontWeight">normal</property>
                                    <property name="fontStyle">normal</property>
                                    <property name="fontVariant">normal</property>
                                    <property name="color">black</property>
                                    <property name="textLineThrough">none</property>
                                    <property name="textOverline">none</property>
                                    <property name="textUnderline">none</property>
                                    <property name="borderBottomColor">black</property>
                                    <property name="borderBottomStyle">none</property>
                                    <property name="borderBottomWidth">medium</property>
                                    <property name="borderLeftColor">black</property>
                                    <property name="borderLeftStyle">none</property>
                                    <property name="borderLeftWidth">medium</property>
                                    <property name="borderRightColor">black</property>
                                    <property name="borderRightStyle">none</property>
                                    <property name="borderRightWidth">medium</property>
                                    <property name="borderTopColor">black</property>
                                    <property name="borderTopStyle">none</property>
                                    <property name="borderTopWidth">medium</property>
                                    <property name="marginTop">0pt</property>
                                    <property name="marginLeft">0pt</property>
                                    <property name="marginBottom">0pt</property>
                                    <property name="marginRight">0pt</property>
                                    <property name="paddingTop">1pt</property>
                                    <property name="paddingLeft">1pt</property>
                                    <property name="paddingBottom">1pt</property>
                                    <property name="paddingRight">1pt</property>
                                    <property name="textAlign">center</property>
                                    <property name="letterSpacing">normal</property>
                                    <property name="lineHeight">normal</property>
                                    <property name="orphans">2</property>
                                    <property name="textTransform">none</property>
                                    <property name="whiteSpace">normal</property>
                                    <property name="widows">2</property>
                                    <property name="wordSpacing">normal</property>
                                    <property name="display">block</property>
                                    <property name="pageBreakAfter">auto</property>
                                    <property name="pageBreakBefore">auto</property>
                                    <property name="pageBreakInside">auto</property>
                                    <property name="showIfBlank">false</property>
                                    <property name="canShrink">false</property>
                                    <property name="overflow">hidden</property>
                                    <property name="resultSetColumn">Column Binding</property>
                                </data>
                            </cell>
                            <cell id="490">
                                <label id="500">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">）年（</text-property>
                                </label>
                            </cell>
                            <cell id="491">
                                <data id="1862">
                                    <property name="backgroundAttachment">scroll</property>
                                    <property name="backgroundPositionX">0%</property>
                                    <property name="backgroundPositionY">0%</property>
                                    <property name="backgroundRepeat">repeat</property>
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontSize">10pt</property>
                                    <property name="fontWeight">normal</property>
                                    <property name="fontStyle">normal</property>
                                    <property name="fontVariant">normal</property>
                                    <property name="color">black</property>
                                    <property name="textLineThrough">none</property>
                                    <property name="textOverline">none</property>
                                    <property name="textUnderline">none</property>
                                    <property name="borderBottomColor">black</property>
                                    <property name="borderBottomStyle">none</property>
                                    <property name="borderBottomWidth">medium</property>
                                    <property name="borderLeftColor">black</property>
                                    <property name="borderLeftStyle">none</property>
                                    <property name="borderLeftWidth">medium</property>
                                    <property name="borderRightColor">black</property>
                                    <property name="borderRightStyle">none</property>
                                    <property name="borderRightWidth">medium</property>
                                    <property name="borderTopColor">black</property>
                                    <property name="borderTopStyle">none</property>
                                    <property name="borderTopWidth">medium</property>
                                    <property name="marginTop">0pt</property>
                                    <property name="marginLeft">0pt</property>
                                    <property name="marginBottom">0pt</property>
                                    <property name="marginRight">0pt</property>
                                    <property name="paddingTop">1pt</property>
                                    <property name="paddingLeft">1pt</property>
                                    <property name="paddingBottom">1pt</property>
                                    <property name="paddingRight">1pt</property>
                                    <property name="textAlign">center</property>
                                    <property name="letterSpacing">normal</property>
                                    <property name="lineHeight">normal</property>
                                    <property name="orphans">2</property>
                                    <property name="textTransform">none</property>
                                    <property name="whiteSpace">normal</property>
                                    <property name="widows">2</property>
                                    <property name="wordSpacing">normal</property>
                                    <property name="display">block</property>
                                    <property name="pageBreakAfter">auto</property>
                                    <property name="pageBreakBefore">auto</property>
                                    <property name="pageBreakInside">auto</property>
                                    <property name="showIfBlank">false</property>
                                    <property name="canShrink">false</property>
                                    <property name="overflow">hidden</property>
                                    <property name="resultSetColumn">Column Binding_1</property>
                                </data>
                            </cell>
                            <cell id="492">
                                <label id="501">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">left</property>
                                    <text-property name="text">）月份</text-property>
                                </label>
                            </cell>
                            <cell id="493">
                                <label id="502">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text"></text-property>
                                </label>
                            </cell>
                            <cell id="494">
                                <property name="colSpan">2</property>
                                <property name="rowSpan">1</property>
                                <label id="503">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text">本考勤共（</text-property>
                                </label>
                            </cell>
                            <cell id="496">
                                <data id="1852">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="textAlign">center</property>
                                    <property name="dataSet">DS_Count</property>
                                    <list-property name="boundDataColumns">
                                        <structure>
                                            <property name="name">COUNT(DISTINCTUSERID)</property>
                                            <text-property name="displayName">COUNT(DISTINCTUSERID)</text-property>
                                            <expression name="expression" type="javascript">dataSetRow["COUNT(DISTINCTUSERID)"]</expression>
                                            <property name="dataType">decimal</property>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">COUNT(DISTINCTUSERID)</property>
                                </data>
                            </cell>
                            <cell id="497">
                                <label id="504">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">left</property>
                                    <text-property name="text">）人</text-property>
                                </label>
                            </cell>
                        </row>
                    </grid>
                </cell>
            </row>
        </grid>
        <extended-item extensionName="Crosstab" extensionVersion="3.7.0" id="1809">
            <property name="cube">Data Cube</property>
            <property name="measures">
                <extended-item extensionName="MeasureView" id="1832">
                    <property name="measure">STATUSVAL</property>
                    <property name="detail">
                        <extended-item extensionName="AggregationCell" id="1833">
                            <property name="aggregationOnRow">Group/SJ</property>
                            <property name="aggregationOnColumn">Group1/DHZ</property>
                            <property name="borderTopStyle">solid</property>
                            <property name="borderTopWidth">1px</property>
                            <property name="borderLeftStyle">solid</property>
                            <property name="borderLeftWidth">1px</property>
                            <property name="borderBottomStyle">solid</property>
                            <property name="borderBottomWidth">1px</property>
                            <property name="borderRightStyle">solid</property>
                            <property name="borderRightWidth">1px</property>
                            <property name="content">
                                <data id="1834">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="textAlign">center</property>
                                    <property name="resultSetColumn">STATUSVAL_Group/SJ_Group1/DHZ</property>
                                </data>
                            </property>
                        </extended-item>
                    </property>
                    <property name="header">
                        <extended-item extensionName="CrosstabCell" id="1835">
                            <property name="height">0in</property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="rows">
                <extended-item extensionName="CrosstabView" id="1815">
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="1816">
                            <property name="dimension">Group</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View" id="1817">
                                    <property name="level">Group/USERNAME</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="1818">
                                            <property name="content">
                                                <data name="USERNAME" id="1819">
                                                    <property name="fontFamily">"宋体"</property>
                                                    <property name="textAlign">center</property>
                                                    <property name="resultSetColumn">USERNAME</property>
                                                </data>
                                            </property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">1px</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">1px</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">1px</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">1px</property>
                                            <property name="width">0.65in</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                                <extended-item extensionName="LevelView" name="NewLevel View1" id="1821">
                                    <property name="level">Group/SJ</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="1822">
                                            <property name="content">
                                                <data name="SJ" id="1824">
                                                    <property name="fontFamily">"宋体"</property>
                                                    <property name="textAlign">center</property>
                                                    <property name="resultSetColumn">SJ</property>
                                                </data>
                                            </property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">1px</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">1px</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">1px</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">1px</property>
                                            <property name="width">0.75in</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="columns">
                <extended-item extensionName="CrosstabView" id="1837">
                    <property name="views">
                        <extended-item extensionName="DimensionView" id="1838">
                            <property name="dimension">Group1</property>
                            <property name="levels">
                                <extended-item extensionName="LevelView" name="NewLevel View3" id="1845">
                                    <property name="level">Group1/WORKDATE</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="1846">
                                            <property name="content">
                                                <data name="DHZ" id="1843">
                                                    <property name="fontFamily">"宋体"</property>
                                                    <property name="textAlign">center</property>
                                                    <method name="onCreate"><![CDATA[if("日"==this.getValue()||"六"==this.getValue()){
this.style.setColor("red");
}]]></method>
                                                    <property name="resultSetColumn">DHZ</property>
                                                </data>
                                            </property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">1px</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">1px</property>
                                            <property name="borderBottomStyle">solid</property>
                                            <property name="borderBottomWidth">1px</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">1px</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                                <extended-item extensionName="LevelView" name="NewLevel View2" id="1839">
                                    <property name="level">Group1/DHZ</property>
                                    <property name="member">
                                        <extended-item extensionName="CrosstabCell" id="1840">
                                            <property name="content">
                                                <data name="WORKDATE" id="1849">
                                                    <property name="fontFamily">"宋体"</property>
                                                    <property name="textAlign">center</property>
                                                    <property name="resultSetColumn">WORKDATE</property>
                                                </data>
                                            </property>
                                            <property name="borderTopStyle">solid</property>
                                            <property name="borderTopWidth">1px</property>
                                            <property name="borderLeftStyle">solid</property>
                                            <property name="borderLeftWidth">1px</property>
                                            <property name="borderRightStyle">solid</property>
                                            <property name="borderRightWidth">1px</property>
                                        </extended-item>
                                    </property>
                                </extended-item>
                            </property>
                        </extended-item>
                    </property>
                </extended-item>
            </property>
            <property name="header">
                <extended-item extensionName="CrosstabCell" id="1847">
                    <property name="content">
                        <label id="1851">
                            <property name="fontFamily">"宋体"</property>
                            <text-property name="text">星期</text-property>
                        </label>
                    </property>
                    <property name="textAlign">center</property>
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">1px</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">1px</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">1px</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">1px</property>
                </extended-item>
                <extended-item extensionName="CrosstabCell" id="1848">
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">1px</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">1px</property>
                    <property name="borderBottomStyle">solid</property>
                    <property name="borderBottomWidth">1px</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">1px</property>
                </extended-item>
                <extended-item extensionName="CrosstabCell" id="1841">
                    <property name="content">
                        <label id="1820">
                            <property name="fontFamily">"宋体"</property>
                            <property name="textAlign">center</property>
                            <text-property name="text">姓名</text-property>
                        </label>
                    </property>
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">1px</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">1px</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">1px</property>
                </extended-item>
                <extended-item extensionName="CrosstabCell" id="1842">
                    <property name="content">
                        <label id="1825">
                            <property name="fontFamily">"宋体"</property>
                            <property name="textAlign">center</property>
                            <text-property name="text">类型</text-property>
                        </label>
                    </property>
                    <property name="borderTopStyle">solid</property>
                    <property name="borderTopWidth">1px</property>
                    <property name="borderLeftStyle">solid</property>
                    <property name="borderLeftWidth">1px</property>
                    <property name="borderRightStyle">solid</property>
                    <property name="borderRightWidth">1px</property>
                </extended-item>
                <extended-item extensionName="CrosstabCell" id="1810"/>
                <extended-item extensionName="CrosstabCell" id="1823"/>
            </property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">USERNAME</property>
                    <expression name="expression">dimension["Group"]["USERNAME"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">SJ</property>
                    <expression name="expression">dimension["Group"]["SJ"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">DHZ</property>
                    <expression name="expression">dimension["Group1"]["DHZ"]</expression>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="name">STATUSVAL_Group/SJ_Group1/DHZ</property>
                    <property name="dataType">string</property>
                    <simple-property-list name="aggregateOn">
                        <value>Group/SJ</value>
                        <value>Group1/DHZ</value>
                    </simple-property-list>
                    <property name="aggregateFunction">FIRST</property>
                    <list-property name="arguments">
                        <structure>
                            <property name="name">Expression</property>
                            <expression name="value" type="javascript">measure["STATUSVAL"]</expression>
                        </structure>
                    </list-property>
                </structure>
                <structure>
                    <property name="name">WORKDATE</property>
                    <expression name="expression">dimension["Group1"]["WORKDATE"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
        </extended-item>
    </body>
</report>
