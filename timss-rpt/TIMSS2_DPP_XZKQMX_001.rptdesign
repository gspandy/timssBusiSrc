<?xml version="1.0" encoding="UTF-8"?>
<report xmlns="http://www.eclipse.org/birt/2005/design" version="3.2.23" id="1">
    <property name="createdBy">Eclipse BIRT Designer Version 4.3.2.v20140211-1400 Build &lt;4.3.2.v20140225-1404></property>
    <list-property name="userProperties">
        <structure>
            <property name="name">Data Cube.DS_Date.x</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
        <structure>
            <property name="name">Data Cube.DS_Date.y</property>
            <property name="type">integer</property>
            <property name="isVisible">false</property>
        </structure>
    </list-property>
    <property name="Data Cube.DS_Date.x">135</property>
    <property name="Data Cube.DS_Date.y">80</property>
    <property name="units">in</property>
    <method name="initialize"><![CDATA[var deptarr = [];
var userarr = [];
var showtitle = "";
var count =0 ;]]></method>
    <property name="iconFile">/templates/blank_report.gif</property>
    <property name="bidiLayoutOrientation">ltr</property>
    <property name="imageDPI">96</property>
    <parameters>
        <scalar-parameter name="deptName" id="1721">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="workdate" id="1722">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="year" id="1932">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="concealValue">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="month" id="1933">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="siteId" id="1934">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="concealValue">false</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="deptId" id="1935">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
        <scalar-parameter name="userId" id="1936">
            <property name="valueType">static</property>
            <property name="isRequired">false</property>
            <property name="dataType">string</property>
            <property name="distinct">true</property>
            <simple-property-list name="defaultValue">
                <value type="constant"></value>
            </simple-property-list>
            <list-property name="selectionList"/>
            <property name="paramType">simple</property>
            <property name="controlType">text-box</property>
            <structure name="format">
                <property name="category">Unformatted</property>
            </structure>
        </scalar-parameter>
    </parameters>
    <data-sources>
        <oda-data-source extensionID="org.eclipse.birt.report.data.oda.jdbc" name="Data_attend Source" id="1718">
            <list-property name="privateDriverProperties">
                <ex-property>
                    <name>metadataBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledMetadataBidiFormatStr</name>
                </ex-property>
                <ex-property>
                    <name>contentBidiFormatStr</name>
                    <value>ILYNN</value>
                </ex-property>
                <ex-property>
                    <name>disabledContentBidiFormatStr</name>
                </ex-property>
            </list-property>
            <property name="odaDriverClass">oracle.jdbc.OracleDriver</property>
            <property name="odaURL">jdbc:oracle:thin:@10.0.17.154:1521:itceam</property>
            <property name="odaUser">timss2test</property>
            <encrypted-property name="odaPassword" encryptionID="base64">YWJj</encrypted-property>
            <property name="odaJndiName">java:comp/env/jdbc/timss2dev</property>
        </oda-data-source>
    </data-sources>
    <data-sets>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="DS_Date" id="1720">
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_23</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">year</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">2</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_9</property>
                    <property name="paramName">month</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">3</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_2</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">4</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_27</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">5</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_24</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">6</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_3</property>
                    <property name="paramName">year</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">7</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_10</property>
                    <property name="paramName">month</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">8</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_4</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">9</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_28</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">10</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_25</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">11</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_5</property>
                    <property name="paramName">year</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">12</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_11</property>
                    <property name="paramName">month</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">13</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_6</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">14</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_29</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">15</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_26</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">16</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_7</property>
                    <property name="paramName">year</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">17</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_12</property>
                    <property name="paramName">month</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">18</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_8</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">19</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_30</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">20</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_13</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">21</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_14</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">22</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_17</property>
                    <property name="paramName">userId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">23</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_15</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">24</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_16</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">25</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_18</property>
                    <property name="paramName">deptId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">26</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">DEPTID</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">DEPTNAME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">3</property>
                        <property name="name">USERID</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">4</property>
                        <property name="name">USERNAME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">5</property>
                        <property name="name">WORKDATETIME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">6</property>
                        <property name="name">D</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">7</property>
                        <property name="name">WORKDATE</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">8</property>
                        <property name="name">SJ</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">9</property>
                        <property name="name">ISOPR</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">10</property>
                        <property name="name">DHZ</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">11</property>
                        <property name="name">STATUSVAL</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data_attend Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">DEPTID</property>
                    <property name="nativeName">DEPTID</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">DEPTNAME</property>
                    <property name="nativeName">DEPTNAME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">3</property>
                    <property name="name">USERID</property>
                    <property name="nativeName">USERID</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">4</property>
                    <property name="name">USERNAME</property>
                    <property name="nativeName">USERNAME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">5</property>
                    <property name="name">WORKDATETIME</property>
                    <property name="nativeName">WORKDATETIME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">6</property>
                    <property name="name">D</property>
                    <property name="nativeName">D</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">7</property>
                    <property name="name">WORKDATE</property>
                    <property name="nativeName">WORKDATE</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">8</property>
                    <property name="name">SJ</property>
                    <property name="nativeName">SJ</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">9</property>
                    <property name="name">ISOPR</property>
                    <property name="nativeName">ISOPR</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">10</property>
                    <property name="name">DHZ</property>
                    <property name="nativeName">DHZ</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">11</property>
                    <property name="name">STATUSVAL</property>
                    <property name="nativeName">STATUSVAL</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[--SQL1
select * from(


SELECT 
partschedule.deptid,
partschedule.deptname,
partschedule.userid,
trim(partschedule.username) as username,
partschedule.workdatetime,
partschedule.D,
partschedule.workdate,
partschedule.sj,
partschedule.isopr,
decode(partschedule.D,'1','日','2','一','3','二','4','三','5','四','6','五','7','六') as DHZ,
case when partschedule.STATUS = '-1' then '休' 
     when partschedule.STATUS2 = '异' then partschedule.STATUS4 
     when partschedule.STATUS2 = '请' then partschedule.STATUS3 
     else partschedule.STATUS2 end as statusVal
FROM
(
SELECT deptid,deptname,userid,/*用户ID*/username,/*用户姓名*/workdate as workdatetime,
to_char(to_date(workdate,'yyyy-MM-dd'),'D') as D,substr( workdate, 9, 2) as workdate, /*天*/'上午上班' as sj,
decode(status,0,'-1','0') as status,--上午上班打卡情况
nvl(B1.ATTRIBUTE1,'') as status2,B2.ATTRIBUTE1 as status3,B3.ATTRIBUTE1 as status4,isopr
FROM ATD_WORKSTATUS A
LEFT JOIN B_ENUM B1 ON B1.ECAT_CODE = 'ATD_WORK_STATUS_TYPE' AND B1.ENUM_CODE = A.mornStartCheckTYPE 
LEFT JOIN B_ENUM B2 ON B2.ECAT_CODE = 'ATD_LEI_CATEGORY' AND B2.ENUM_CODE = A.mornStartCheck AND B2.SITEID = A.SITEID
LEFT JOIN B_ENUM B3 ON B3.ECAT_CODE = 'ATD_AB_CATEGORY' AND B3.ENUM_CODE = A.mornStartCheck AND B3.SITEID = A.SITEID
WHERE A.siteId = ?
AND substr( workdate, 0, 4) = ?
AND substr( workdate, 6, 2) = ?
AND (A.deptid in (
		select distinct so.org_code from sec_organization so
        where so.org_code like (select distinct sso.org_code from sec_site_organization sso where sso.site_id = 'DPP')||'%'
        start with instr(so.name, nvl(?,'xxx')) > 0
        connect by prior so.org_code = so.parent_code
) or nvl(?,'xxx')='xxx')
and not exists(
select 1 from atd_exempt e
where (e.type='user_id' and e.relationid = userid) or (e.type='org_code' and e.relationid = deptid)
)

union 
SELECT deptid,deptname,userid,/*用户ID*/username,/*用户姓名*/workdate as workdatetime,
to_char(to_date(workdate,'yyyy-MM-dd'),'D') as D,substr( workdate, 9, 2) as workdate, /*天*/'上午下班' as sj,
decode(status,0,'-1','0') as status,--上午下班打卡情况
nvl(B1.ATTRIBUTE1,'') as status2,B2.ATTRIBUTE1 as status3,B3.ATTRIBUTE1 as status4,isopr
FROM ATD_WORKSTATUS A 
LEFT JOIN B_ENUM B1 ON B1.ECAT_CODE = 'ATD_WORK_STATUS_TYPE' AND B1.ENUM_CODE = A.mornEndCheckTYPE 
LEFT JOIN B_ENUM B2 ON B2.ECAT_CODE = 'ATD_LEI_CATEGORY' AND B2.ENUM_CODE = A.mornEndCheck AND B2.SITEID = A.SITEID
LEFT JOIN B_ENUM B3 ON B3.ECAT_CODE = 'ATD_AB_CATEGORY' AND B3.ENUM_CODE = A.mornEndCheck AND B3.SITEID = A.SITEID
WHERE A.siteId = ?
AND substr( workdate, 0, 4) = ?
AND substr( workdate, 6, 2) = ?
AND (A.deptid in (
		select distinct so.org_code from sec_organization so
        where so.org_code like (select distinct sso.org_code from sec_site_organization sso where sso.site_id = 'DPP')||'%'
        start with instr(so.name, nvl(?,'xxx')) > 0
        connect by prior so.org_code = so.parent_code

) or nvl(?,'xxx')='xxx')
and not exists(
select 1 from atd_exempt e
where (e.type='user_id' and e.relationid = userid) or (e.type='org_code' and e.relationid = deptid)
)

union 
SELECT deptid,deptname,userid,/*用户ID*/username,/*用户姓名*/workdate as workdatetime,
to_char(to_date(workdate,'yyyy-MM-dd'),'D') as D,substr( workdate, 9, 2) as workdate, /*天*/'下午上班' as sj,
decode(status,0,'-1','0') as status,--上午下班打卡情况
nvl(B1.ATTRIBUTE1,'') as status2,B2.ATTRIBUTE1 as status3,B3.ATTRIBUTE1 as status4,isopr
FROM ATD_WORKSTATUS A 
LEFT JOIN B_ENUM B1 ON B1.ECAT_CODE = 'ATD_WORK_STATUS_TYPE' AND B1.ENUM_CODE = A.noonStartChecktype 
LEFT JOIN B_ENUM B2 ON B2.ECAT_CODE = 'ATD_LEI_CATEGORY' AND B2.ENUM_CODE = A.noonStartCheck AND B2.SITEID = A.SITEID
LEFT JOIN B_ENUM B3 ON B3.ECAT_CODE = 'ATD_AB_CATEGORY' AND B3.ENUM_CODE = A.noonStartCheck AND B3.SITEID = A.SITEID
WHERE A.siteId = ?
AND substr( workdate, 0, 4) = ?
AND substr( workdate, 6, 2) = ?
AND (A.deptid in (
		select distinct so.org_code from sec_organization so
        where so.org_code like (select distinct sso.org_code from sec_site_organization sso where sso.site_id = 'DPP')||'%'
        start with instr(so.name, nvl(?,'xxx')) > 0
        connect by prior so.org_code = so.parent_code

) or nvl(?,'xxx')='xxx')
and not exists(
select 1 from atd_exempt e
where (e.type='user_id' and e.relationid = userid) or (e.type='org_code' and e.relationid = deptid)
)

union 
SELECT deptid,deptname,userid,/*用户ID*/username,/*用户姓名*/workdate as workdatetime,
to_char(to_date(workdate,'yyyy-MM-dd'),'D') as D,substr( workdate, 9, 2) as workdate, /*天*/'下午下班' as sj,
decode(status,0,'-1','0') as status,--上午下班打卡情况
nvl(B1.ATTRIBUTE1,'') as status2,B2.ATTRIBUTE1 as status3,B3.ATTRIBUTE1 as status4,isopr
FROM ATD_WORKSTATUS A 
LEFT JOIN B_ENUM B1 ON B1.ECAT_CODE = 'ATD_WORK_STATUS_TYPE' AND B1.ENUM_CODE = A.noonEndChecktype 
LEFT JOIN B_ENUM B2 ON B2.ECAT_CODE = 'ATD_LEI_CATEGORY' AND B2.ENUM_CODE = A.noonEndCheck AND B2.SITEID = A.SITEID
LEFT JOIN B_ENUM B3 ON B3.ECAT_CODE = 'ATD_AB_CATEGORY' AND B3.ENUM_CODE = A.noonEndCheck AND B3.SITEID = A.SITEID
WHERE A.siteId = ?
AND substr( workdate, 0, 4) = ?
AND substr( workdate, 6, 2) = ?
AND (A.deptid in (
		select distinct so.org_code from sec_organization so
        where so.org_code like (select distinct sso.org_code from sec_site_organization sso where sso.site_id = 'DPP')||'%'
        start with instr(so.name, nvl(?,'xxx')) > 0
        connect by prior so.org_code = so.parent_code

) or nvl(?,'xxx')='xxx')
and not exists(
select 1 from atd_exempt e
where (e.type='user_id' and e.relationid = userid) or (e.type='org_code' and e.relationid = deptid)
)

) partschedule
where partschedule.isopr<>'Y'
order by partschedule.userid asc,partschedule.sj


) a
where (nvl(?,'-')='-' or nvl(?,'-')<>'-' and a.userId like '%'||?||'%')
and (nvl(?,'-')='-' or nvl(?,'-')<>'-' and a.deptId  in (select distinct org_code from sec_organization o start with o.org_code =? connect by prior org_code = o.parent_code))
order by a.workdate asc

--【解析】
--1、主体由4段类似的sql union起来，因为分别对应四次打卡，因为四次打卡放在了4个字段。
--2、考勤状态的对应关系，优先取**Checktype的枚举值，
--但，如果**Checktype的枚举值是【异】，说明是考勤异常，那么就要取**Check对应ATD_AB_CATEGORY的枚举(专门的考勤异常枚举)
--如果**Checktype的枚举值是【请】，说明是请假，那么就要取**Check对应ATD_LEI_CATEGORY的枚举(专门的请假枚举)
--3、每一段都有一个atd_exempt ，是用于一些特殊的人，不计考勤。]]></xml-property>
            <property name="rowFetchSize">1</property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="DS_Dept" id="1723">
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_8</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
                <structure>
                    <property name="name">param_9</property>
                    <property name="paramName">deptName</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">2</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">TITLE</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data_attend Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">TITLE</property>
                    <property name="nativeName">TITLE</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select wm_concat(distinct deptName) as title
from ATD_WORKSTATUS A
where isopr<>'Y' and siteid = ?
and A.deptid in (
	    select distinct so.org_code from sec_organization so
        where so.org_code like (select distinct sso.org_code from sec_site_organization sso where sso.site_id = 'DPP')||'%'
        start with instr(so.name, nvl(?,'部')) > 0
        connect by prior so.org_code = so.parent_code

)]]></xml-property>
            <property name="rowFetchSize">1</property>
        </oda-data-set>
        <oda-data-set extensionID="org.eclipse.birt.report.data.oda.jdbc.JdbcSelectDataSet" name="Ds_Site" id="1943">
            <list-property name="columnHints"/>
            <list-property name="parameters">
                <structure>
                    <property name="name">param_1</property>
                    <property name="paramName">siteId</property>
                    <property name="nativeName"></property>
                    <property name="dataType">string</property>
                    <property name="nativeDataType">0</property>
                    <property name="position">1</property>
                    <property name="isOptional">false</property>
                    <property name="isInput">true</property>
                    <property name="isOutput">false</property>
                </structure>
            </list-property>
            <structure name="cachedMetaData">
                <list-property name="resultSet">
                    <structure>
                        <property name="position">1</property>
                        <property name="name">NAME</property>
                        <property name="dataType">string</property>
                    </structure>
                    <structure>
                        <property name="position">2</property>
                        <property name="name">SHORT_NAME</property>
                        <property name="dataType">string</property>
                    </structure>
                </list-property>
            </structure>
            <property name="dataSource">Data_attend Source</property>
            <list-property name="resultSet">
                <structure>
                    <property name="position">1</property>
                    <property name="name">NAME</property>
                    <property name="nativeName">NAME</property>
                    <property name="dataType">string</property>
                </structure>
                <structure>
                    <property name="position">2</property>
                    <property name="name">SHORT_NAME</property>
                    <property name="nativeName">SHORT_NAME</property>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <xml-property name="queryText"><![CDATA[select a.name,a.short_name from sec_organization a, sec_site_organization b
where a.org_code = b.org_code
and b.site_id=?]]></xml-property>
            <property name="rowFetchSize">1</property>
        </oda-data-set>
    </data-sets>
    <cubes>
        <tabular-cube name="Data Cube1" id="1841">
            <property name="dimensions">
                <tabular-dimension name="Group2" id="1842">
                    <property name="defaultHierarchy">NewTabularHierarchy2</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy2" id="1843">
                            <property name="levels">
                                <tabular-level name="USERNAME" id="1844">
                                    <property name="dataType">string</property>
                                    <property name="columnName">USERNAME</property>
                                </tabular-level>
                                <tabular-level name="SJ" id="1845">
                                    <property name="dataType">string</property>
                                    <property name="columnName">SJ</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
                <tabular-dimension name="Group3" id="1846">
                    <property name="defaultHierarchy">NewTabularHierarchy3</property>
                    <property name="hierarchies">
                        <tabular-hierarchy name="NewTabularHierarchy3" id="1847">
                            <property name="levels">
                                <tabular-level name="WORKDATE" id="1848">
                                    <property name="dataType">string</property>
                                    <property name="levelType">dynamic</property>
                                    <property name="columnName">WORKDATE</property>
                                </tabular-level>
                                <tabular-level name="DHZ" id="1849">
                                    <property name="dataType">string</property>
                                    <property name="columnName">DHZ</property>
                                </tabular-level>
                            </property>
                        </tabular-hierarchy>
                    </property>
                </tabular-dimension>
            </property>
            <property name="measureGroups">
                <tabular-measure-group name="Summary Field1" id="1850">
                    <property name="measures">
                        <tabular-measure name="STATUSVAL1" id="1851">
                            <property name="function">first</property>
                            <property name="isCalculated">false</property>
                            <expression name="measureExpression" type="javascript">dataSetRow["STATUSVAL"]</expression>
                            <property name="dataType">string</property>
                            <property name="isVisible">true</property>
                        </tabular-measure>
                    </property>
                </tabular-measure-group>
            </property>
            <property name="dataSet">DS_Date</property>
        </tabular-cube>
    </cubes>
    <page-setup>
        <simple-master-page name="Simple MasterPage" id="2">
            <property name="type">a4</property>
            <property name="orientation">landscape</property>
        </simple-master-page>
    </page-setup>
    <body>
        <grid id="83">
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">year</property>
                    <text-property name="displayName">year</text-property>
                    <expression name="expression" type="javascript">""</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">month</property>
                    <text-property name="displayName">month</text-property>
                    <expression name="expression" type="javascript">""</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">pageCount</property>
                    <text-property name="displayName">pageCount</text-property>
                    <expression name="expression" type="javascript">""</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">men</property>
                    <text-property name="displayName">men</text-property>
                    <expression name="expression" type="javascript">""&#13;
</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">men1</property>
                    <text-property name="displayName">men</text-property>
                    <expression name="expression" type="javascript">""</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Column Binding</property>
                    <expression name="expression" type="javascript">decodeURIComponent(params["deptName"].value)</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_1</property>
                    <expression name="expression" type="javascript">""!=params["year"].value?params["year"].value:""</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
                <structure>
                    <property name="name">Column Binding_2</property>
                    <expression name="expression" type="javascript">""!=params["month"].value?params["month"].value:""</expression>
                    <property name="dataType">string</property>
                    <property name="allowExport">true</property>
                </structure>
            </list-property>
            <column id="1931">
                <property name="width">20px</property>
            </column>
            <column id="85"/>
            <row id="1183">
                <property name="height">0.719in</property>
                <cell id="1928">
                    <property name="borderBottomStyle">none</property>
                    <property name="borderLeftStyle">none</property>
                    <property name="borderRightStyle">none</property>
                    <property name="borderTopStyle">none</property>
                    <property name="paddingTop">0pt</property>
                    <property name="paddingLeft">0pt</property>
                    <property name="paddingBottom">10pt</property>
                    <property name="paddingRight">0pt</property>
                    <property name="textAlign">center</property>
                    <property name="verticalAlign">middle</property>
                </cell>
                <cell id="1184">
                    <property name="colSpan">1</property>
                    <property name="rowSpan">1</property>
                    <property name="borderBottomStyle">none</property>
                    <property name="borderLeftStyle">none</property>
                    <property name="borderRightStyle">none</property>
                    <property name="borderTopStyle">none</property>
                    <property name="paddingTop">0pt</property>
                    <property name="paddingLeft">0pt</property>
                    <property name="paddingBottom">10pt</property>
                    <property name="paddingRight">0pt</property>
                    <property name="textAlign">center</property>
                    <property name="verticalAlign">middle</property>
                    <grid id="1464">
                        <column id="1465">
                            <property name="width">90px</property>
                        </column>
                        <column id="1466">
                            <property name="width">9.947916666666666in</property>
                        </column>
                        <row id="1467">
                            <cell id="1468">
                                <property name="paddingTop">0pt</property>
                                <property name="paddingLeft">0pt</property>
                                <property name="paddingBottom">0pt</property>
                                <property name="paddingRight">0pt</property>
                                <property name="textAlign">left</property>
                                <image id="1471">
                                    <property name="height">0.4266666666666667in</property>
                                    <property name="width">0.8533333333333334in</property>
                                    <property name="source">file</property>
                                    <expression name="uri" type="constant">logo2.jpg</expression>
                                </image>
                            </cell>
                            <cell id="1469">
                                <property name="paddingRight">1pt</property>
                                <property name="verticalAlign">top</property>
                                <data id="1944">
                                    <property name="backgroundAttachment">scroll</property>
                                    <property name="backgroundPositionX">0%</property>
                                    <property name="backgroundPositionY">0%</property>
                                    <property name="backgroundRepeat">repeat</property>
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontSize">14pt</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="fontStyle">normal</property>
                                    <property name="fontVariant">normal</property>
                                    <property name="color">black</property>
                                    <property name="textLineThrough">none</property>
                                    <property name="textOverline">none</property>
                                    <property name="textUnderline">none</property>
                                    <property name="borderBottomColor">black</property>
                                    <property name="borderBottomStyle">none</property>
                                    <property name="borderBottomWidth">medium</property>
                                    <property name="borderLeftColor">black</property>
                                    <property name="borderLeftStyle">none</property>
                                    <property name="borderLeftWidth">medium</property>
                                    <property name="borderRightColor">black</property>
                                    <property name="borderRightStyle">none</property>
                                    <property name="borderRightWidth">medium</property>
                                    <property name="borderTopColor">black</property>
                                    <property name="borderTopStyle">none</property>
                                    <property name="borderTopWidth">medium</property>
                                    <property name="marginTop">0pt</property>
                                    <property name="marginLeft">0pt</property>
                                    <property name="marginBottom">0pt</property>
                                    <property name="marginRight">0pt</property>
                                    <property name="paddingTop">1pt</property>
                                    <property name="paddingLeft">1pt</property>
                                    <property name="paddingBottom">1pt</property>
                                    <property name="paddingRight">1pt</property>
                                    <property name="textAlign">center</property>
                                    <property name="letterSpacing">normal</property>
                                    <property name="lineHeight">normal</property>
                                    <property name="orphans">2</property>
                                    <property name="textTransform">none</property>
                                    <property name="whiteSpace">normal</property>
                                    <property name="widows">2</property>
                                    <property name="wordSpacing">normal</property>
                                    <property name="display">block</property>
                                    <property name="pageBreakAfter">auto</property>
                                    <property name="pageBreakBefore">auto</property>
                                    <property name="pageBreakInside">auto</property>
                                    <property name="showIfBlank">false</property>
                                    <property name="canShrink">false</property>
                                    <property name="overflow">hidden</property>
                                    <property name="dataSet">Ds_Site</property>
                                    <list-property name="boundDataColumns">
                                        <structure>
                                            <property name="name">NAME</property>
                                            <text-property name="displayName">NAME</text-property>
                                            <expression name="expression" type="javascript">dataSetRow["NAME"]</expression>
                                            <property name="dataType">string</property>
                                        </structure>
                                        <structure>
                                            <property name="name">SHORT_NAME</property>
                                            <text-property name="displayName">SHORT_NAME</text-property>
                                            <expression name="expression" type="javascript">dataSetRow["SHORT_NAME"]</expression>
                                            <property name="dataType">string</property>
                                        </structure>
                                        <structure>
                                            <property name="name">Column Binding</property>
                                            <expression name="expression" type="javascript">row["NAME"]+"员工考勤表（明细）"</expression>
                                            <property name="dataType">string</property>
                                            <property name="allowExport">true</property>
                                        </structure>
                                    </list-property>
                                    <property name="resultSetColumn">Column Binding</property>
                                </data>
                            </cell>
                        </row>
                    </grid>
                </cell>
            </row>
            <row id="1946">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">true</expression>
                    </structure>
                </list-property>
                <cell id="1947">
                    <property name="borderBottomStyle">none</property>
                    <property name="borderLeftStyle">none</property>
                    <property name="borderRightStyle">none</property>
                    <property name="borderTopStyle">none</property>
                    <property name="paddingTop">0pt</property>
                    <property name="paddingLeft">0pt</property>
                    <property name="paddingBottom">0pt</property>
                    <property name="paddingRight">0pt</property>
                    <property name="textAlign">center</property>
                    <property name="verticalAlign">middle</property>
                </cell>
                <cell id="1948">
                    <property name="borderBottomStyle">none</property>
                    <property name="borderLeftStyle">none</property>
                    <property name="borderRightStyle">none</property>
                    <property name="borderTopStyle">none</property>
                    <property name="paddingTop">0pt</property>
                    <property name="paddingLeft">0pt</property>
                    <property name="paddingBottom">0pt</property>
                    <property name="paddingRight">0pt</property>
                    <property name="textAlign">center</property>
                    <property name="verticalAlign">middle</property>
                    <table id="1949">
                        <property name="dataSet">DS_Date</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">DEPTNAME</property>
                                <text-property name="displayName">DEPTNAME</text-property>
                                <expression name="expression" type="javascript">dataSetRow["DEPTNAME"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">USERID</property>
                                <text-property name="displayName">USERID</text-property>
                                <expression name="expression" type="javascript">dataSetRow["USERID"]</expression>
                                <property name="dataType">string</property>
                                <property name="allowExport">true</property>
                            </structure>
                        </list-property>
                        <column id="1958"/>
                        <detail>
                            <row id="1953">
                                <cell id="1954">
                                    <data id="1955">
                                        <method name="onCreate"><![CDATA[if(deptarr.indexOf(row["DEPTNAME"])==-1){
deptarr.push(row["DEPTNAME"]);
showtitle+= row["DEPTNAME"]+",";
}
if(userarr.indexOf(row["USERID"])==-1){
userarr.push(row["USERID"]);
}]]></method>
                                        <property name="resultSetColumn">DEPTNAME</property>
                                    </data>
                                </cell>
                            </row>
                        </detail>
                    </table>
                </cell>
            </row>
            <row id="470">
                <cell id="1930">
                    <property name="colSpan">2</property>
                    <property name="rowSpan">1</property>
                    <property name="borderBottomStyle">none</property>
                    <property name="borderLeftStyle">none</property>
                    <property name="borderRightStyle">none</property>
                    <property name="borderTopStyle">none</property>
                    <property name="paddingTop">0pt</property>
                    <property name="paddingLeft">0pt</property>
                    <property name="paddingBottom">0pt</property>
                    <property name="paddingRight">0pt</property>
                    <property name="textAlign">center</property>
                    <property name="verticalAlign">middle</property>
                    <grid id="472">
                        <property name="borderBottomStyle">none</property>
                        <property name="borderLeftStyle">none</property>
                        <property name="borderRightStyle">none</property>
                        <property name="borderTopStyle">none</property>
                        <property name="width">11.0625in</property>
                        <column id="473">
                            <property name="width">100px</property>
                        </column>
                        <column id="474">
                            <property name="width">2.5208333333333335in</property>
                        </column>
                        <column id="475">
                            <property name="width">0.8020833333333334in</property>
                        </column>
                        <column id="476">
                            <property name="width">0.375in</property>
                        </column>
                        <column id="477">
                            <property name="width">0.5625in</property>
                        </column>
                        <column id="478">
                            <property name="width">0.2916666666666667in</property>
                        </column>
                        <column id="479">
                            <property name="width">1.3020833333333333in</property>
                        </column>
                        <column id="480">
                            <property name="width">150px</property>
                        </column>
                        <column id="481">
                            <property name="width">60px</property>
                        </column>
                        <column id="482">
                            <property name="width">70px</property>
                        </column>
                        <column id="483">
                            <property name="width">60px</property>
                        </column>
                        <column id="484">
                            <property name="width">60px</property>
                        </column>
                        <row id="485">
                            <cell id="486">
                                <label id="498">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text">部门名称：</text-property>
                                </label>
                            </cell>
                            <cell id="487">
                                <property name="backgroundAttachment">scroll</property>
                                <property name="backgroundImageType">url</property>
                                <property name="backgroundPositionX">0%</property>
                                <property name="backgroundPositionY">0%</property>
                                <property name="backgroundRepeat">repeat</property>
                                <property name="backgroundSizeHeight">auto</property>
                                <property name="backgroundSizeWidth">auto</property>
                                <property name="fontFamily">"宋体"</property>
                                <property name="fontSize">10pt</property>
                                <property name="fontWeight">normal</property>
                                <property name="fontStyle">normal</property>
                                <property name="fontVariant">normal</property>
                                <property name="color">black</property>
                                <property name="textLineThrough">none</property>
                                <property name="textOverline">none</property>
                                <property name="textUnderline">none</property>
                                <property name="borderBottomColor">black</property>
                                <property name="borderBottomStyle">none</property>
                                <property name="borderBottomWidth">medium</property>
                                <property name="borderLeftColor">black</property>
                                <property name="borderLeftStyle">none</property>
                                <property name="borderLeftWidth">medium</property>
                                <property name="borderRightColor">black</property>
                                <property name="borderRightStyle">none</property>
                                <property name="borderRightWidth">medium</property>
                                <property name="borderTopColor">black</property>
                                <property name="borderTopStyle">none</property>
                                <property name="borderTopWidth">medium</property>
                                <property name="marginTop">0pt</property>
                                <property name="marginLeft">0pt</property>
                                <property name="marginBottom">0pt</property>
                                <property name="marginRight">0pt</property>
                                <property name="paddingTop">1pt</property>
                                <property name="paddingLeft">1pt</property>
                                <property name="paddingBottom">1pt</property>
                                <property name="paddingRight">1pt</property>
                                <property name="textIndent">0em</property>
                                <property name="letterSpacing">normal</property>
                                <property name="lineHeight">normal</property>
                                <property name="orphans">2</property>
                                <property name="textTransform">none</property>
                                <property name="whiteSpace">normal</property>
                                <property name="widows">2</property>
                                <property name="wordSpacing">normal</property>
                                <property name="display">block</property>
                                <property name="pageBreakAfter">auto</property>
                                <property name="pageBreakBefore">auto</property>
                                <property name="pageBreakInside">auto</property>
                                <property name="showIfBlank">false</property>
                                <property name="canShrink">false</property>
                                <property name="overflow">hidden</property>
                                <data id="1945">
                                    <property name="textAlign">left</property>
                                    <method name="onCreate"><![CDATA[if(showtitle.indexOf(",")>-1){
showtitle = showtitle.substring(0,showtitle.length-1);
}
this.setDisplayValue(showtitle);]]></method>
                                    <property name="resultSetColumn">SHOWTITLE</property>
                                </data>
                            </cell>
                            <cell id="488">
                                <label id="499">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text">（</text-property>
                                </label>
                            </cell>
                            <cell id="489">
                                <data id="1911">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="resultSetColumn">Column Binding_1</property>
                                </data>
                            </cell>
                            <cell id="490">
                                <label id="500">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <text-property name="text">）年（</text-property>
                                </label>
                            </cell>
                            <cell id="491">
                                <data id="1910">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="resultSetColumn">Column Binding_2</property>
                                </data>
                            </cell>
                            <cell id="492">
                                <label id="501">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">left</property>
                                    <text-property name="text">）月份</text-property>
                                </label>
                            </cell>
                            <cell id="493">
                                <label id="502">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text"></text-property>
                                </label>
                            </cell>
                            <cell id="494">
                                <property name="colSpan">2</property>
                                <property name="rowSpan">1</property>
                                <label id="503">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">right</property>
                                    <text-property name="text">本考勤共（</text-property>
                                </label>
                            </cell>
                            <cell id="496">
                                <data id="1780">
                                    <property name="fontFamily">"宋体"</property>
                                    <method name="onCreate"><![CDATA[this.setDisplayValue(userarr.length);]]></method>
                                    <property name="resultSetColumn">COUNT(DISTINCTUSERID)</property>
                                </data>
                            </cell>
                            <cell id="497">
                                <label id="504">
                                    <property name="fontFamily">"宋体"</property>
                                    <property name="fontWeight">bold</property>
                                    <property name="textAlign">left</property>
                                    <text-property name="text">）人</text-property>
                                </label>
                            </cell>
                        </row>
                    </grid>
                </cell>
            </row>
        </grid>
        <grid id="1937">
            <property name="dataSet">DS_Dept</property>
            <list-property name="boundDataColumns">
                <structure>
                    <property name="name">TITLE</property>
                    <text-property name="displayName">TITLE</text-property>
                    <expression name="expression" type="javascript">dataSetRow["TITLE"]</expression>
                    <property name="dataType">string</property>
                </structure>
            </list-property>
            <column id="1938"/>
            <row id="1939">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">null!=row["TITLE"]?true:false</expression>
                    </structure>
                </list-property>
                <cell id="1940">
                    <property name="paddingTop">100pt</property>
                    <label id="1876">
                        <property name="fontFamily">"宋体"</property>
                        <property name="textAlign">center</property>
                        <text-property name="text">无考勤数据</text-property>
                    </label>
                </cell>
            </row>
            <row id="1941">
                <list-property name="visibility">
                    <structure>
                        <property name="format">all</property>
                        <expression name="valueExpr" type="javascript">null==row["TITLE"]?true:false</expression>
                    </structure>
                </list-property>
                <cell id="1942">
                    <extended-item extensionName="Crosstab" extensionVersion="3.7.0" id="1852">
                        <property name="cube">Data Cube1</property>
                        <property name="measures">
                            <extended-item extensionName="MeasureView" id="1896">
                                <property name="measure">STATUSVAL1</property>
                                <property name="detail">
                                    <extended-item extensionName="AggregationCell" id="1897">
                                        <property name="aggregationOnRow">Group2/SJ</property>
                                        <property name="aggregationOnColumn">Group3/DHZ</property>
                                        <property name="borderTopStyle">solid</property>
                                        <property name="borderTopWidth">1px</property>
                                        <property name="borderLeftStyle">solid</property>
                                        <property name="borderLeftWidth">1px</property>
                                        <property name="borderBottomStyle">solid</property>
                                        <property name="borderBottomWidth">1px</property>
                                        <property name="borderRightStyle">solid</property>
                                        <property name="borderRightWidth">1px</property>
                                        <property name="content">
                                            <data id="1898">
                                                <property name="fontFamily">"宋体"</property>
                                                <property name="textAlign">center</property>
                                                <property name="resultSetColumn">STATUSVAL1_Group2/SJ_Group3/DHZ</property>
                                            </data>
                                        </property>
                                    </extended-item>
                                </property>
                                <property name="header">
                                    <extended-item extensionName="CrosstabCell" id="1899">
                                        <property name="borderLeftStyle">solid</property>
                                        <property name="borderLeftWidth">1px</property>
                                        <property name="borderRightStyle">solid</property>
                                        <property name="borderRightWidth">1px</property>
                                        <property name="height">0in</property>
                                    </extended-item>
                                </property>
                            </extended-item>
                        </property>
                        <property name="rows">
                            <extended-item extensionName="CrosstabView" id="1856">
                                <property name="views">
                                    <extended-item extensionName="DimensionView" id="1857">
                                        <property name="dimension">Group2</property>
                                        <property name="levels">
                                            <extended-item extensionName="LevelView" name="NewLevel View4" id="1858">
                                                <property name="level">Group2/USERNAME</property>
                                                <property name="member">
                                                    <extended-item extensionName="CrosstabCell" id="1859">
                                                        <property name="content">
                                                            <data name="USERNAME1" id="1860">
                                                                <property name="fontFamily">"宋体"</property>
                                                                <property name="textAlign">center</property>
                                                                <property name="resultSetColumn">USERNAME</property>
                                                            </data>
                                                        </property>
                                                        <property name="borderTopStyle">solid</property>
                                                        <property name="borderTopWidth">1px</property>
                                                        <property name="borderLeftStyle">solid</property>
                                                        <property name="borderLeftWidth">1px</property>
                                                        <property name="borderBottomStyle">solid</property>
                                                        <property name="borderBottomWidth">1px</property>
                                                        <property name="borderRightStyle">solid</property>
                                                        <property name="borderRightWidth">1px</property>
                                                        <property name="width">0.65in</property>
                                                    </extended-item>
                                                </property>
                                            </extended-item>
                                            <extended-item extensionName="LevelView" name="NewLevel View5" id="1862">
                                                <property name="level">Group2/SJ</property>
                                                <property name="member">
                                                    <extended-item extensionName="CrosstabCell" id="1863">
                                                        <property name="content">
                                                            <data name="SJ1" id="1865">
                                                                <property name="fontFamily">"宋体"</property>
                                                                <property name="textAlign">center</property>
                                                                <property name="resultSetColumn">SJ</property>
                                                            </data>
                                                        </property>
                                                        <property name="borderTopStyle">solid</property>
                                                        <property name="borderTopWidth">1px</property>
                                                        <property name="borderLeftStyle">solid</property>
                                                        <property name="borderLeftWidth">1px</property>
                                                        <property name="borderBottomStyle">solid</property>
                                                        <property name="borderBottomWidth">1px</property>
                                                        <property name="borderRightStyle">solid</property>
                                                        <property name="borderRightWidth">1px</property>
                                                        <property name="width">0.75in</property>
                                                    </extended-item>
                                                </property>
                                            </extended-item>
                                        </property>
                                    </extended-item>
                                </property>
                            </extended-item>
                        </property>
                        <property name="columns">
                            <extended-item extensionName="CrosstabView" id="1867">
                                <property name="views">
                                    <extended-item extensionName="DimensionView" id="1912">
                                        <property name="dimension">Group3</property>
                                        <property name="levels">
                                            <extended-item extensionName="LevelView" name="NewLevel View6" id="1913">
                                                <property name="level">Group3/WORKDATE</property>
                                                <property name="member">
                                                    <extended-item extensionName="CrosstabCell" id="1914">
                                                        <property name="content">
                                                            <data name="DHZ1" id="1923">
                                                                <property name="fontFamily">"宋体"</property>
                                                                <property name="textAlign">center</property>
                                                                <method name="onCreate"><![CDATA[if("日"==this.getValue()||"六"==this.getValue()){
this.style.setColor("red");
}]]></method>
                                                                <property name="resultSetColumn">DHZ</property>
                                                            </data>
                                                        </property>
                                                        <property name="borderTopStyle">solid</property>
                                                        <property name="borderTopWidth">1px</property>
                                                        <property name="borderLeftStyle">solid</property>
                                                        <property name="borderLeftWidth">1px</property>
                                                        <property name="borderBottomStyle">solid</property>
                                                        <property name="borderBottomWidth">1px</property>
                                                        <property name="borderRightStyle">solid</property>
                                                        <property name="borderRightWidth">1px</property>
                                                    </extended-item>
                                                </property>
                                            </extended-item>
                                            <extended-item extensionName="LevelView" name="NewLevel View7" id="1919">
                                                <property name="level">Group3/DHZ</property>
                                                <property name="member">
                                                    <extended-item extensionName="CrosstabCell" id="1920">
                                                        <property name="content">
                                                            <data name="WORKDATE" id="1917">
                                                                <property name="fontFamily">"宋体"</property>
                                                                <property name="textAlign">center</property>
                                                                <property name="resultSetColumn">WORKDATE</property>
                                                            </data>
                                                        </property>
                                                        <property name="borderTopStyle">solid</property>
                                                        <property name="borderTopWidth">1px</property>
                                                        <property name="borderLeftStyle">solid</property>
                                                        <property name="borderLeftWidth">1px</property>
                                                        <property name="borderRightStyle">solid</property>
                                                        <property name="borderRightWidth">1px</property>
                                                    </extended-item>
                                                </property>
                                            </extended-item>
                                        </property>
                                    </extended-item>
                                </property>
                            </extended-item>
                        </property>
                        <property name="header">
                            <extended-item extensionName="CrosstabCell" id="1915">
                                <property name="content">
                                    <label id="1925">
                                        <property name="fontFamily">"宋体"</property>
                                        <property name="textAlign">center</property>
                                        <text-property name="text">星期</text-property>
                                    </label>
                                </property>
                                <property name="borderTopStyle">solid</property>
                                <property name="borderTopWidth">1px</property>
                                <property name="borderLeftStyle">solid</property>
                                <property name="borderLeftWidth">1px</property>
                                <property name="borderBottomStyle">solid</property>
                                <property name="borderBottomWidth">1px</property>
                                <property name="borderRightStyle">solid</property>
                                <property name="borderRightWidth">1px</property>
                            </extended-item>
                            <extended-item extensionName="CrosstabCell" id="1916">
                                <property name="borderTopStyle">solid</property>
                                <property name="borderTopWidth">1px</property>
                                <property name="borderLeftStyle">solid</property>
                                <property name="borderLeftWidth">1px</property>
                                <property name="borderBottomStyle">solid</property>
                                <property name="borderBottomWidth">1px</property>
                                <property name="borderRightStyle">solid</property>
                                <property name="borderRightWidth">1px</property>
                            </extended-item>
                            <extended-item extensionName="CrosstabCell" id="1921">
                                <property name="content">
                                    <label id="1926">
                                        <property name="fontFamily">"宋体"</property>
                                        <property name="textAlign">center</property>
                                        <text-property name="text">姓名</text-property>
                                    </label>
                                </property>
                                <property name="borderTopStyle">solid</property>
                                <property name="borderTopWidth">1px</property>
                                <property name="borderLeftStyle">solid</property>
                                <property name="borderLeftWidth">1px</property>
                                <property name="borderRightStyle">solid</property>
                                <property name="borderRightWidth">1px</property>
                            </extended-item>
                            <extended-item extensionName="CrosstabCell" id="1922">
                                <property name="content">
                                    <label id="1927">
                                        <property name="fontFamily">"宋体"</property>
                                        <property name="textAlign">center</property>
                                        <text-property name="text">类型</text-property>
                                    </label>
                                </property>
                                <property name="borderTopStyle">solid</property>
                                <property name="borderTopWidth">1px</property>
                                <property name="borderLeftStyle">solid</property>
                                <property name="borderLeftWidth">1px</property>
                                <property name="borderRightStyle">solid</property>
                                <property name="borderRightWidth">1px</property>
                            </extended-item>
                            <extended-item extensionName="CrosstabCell" id="1853">
                                <property name="borderLeftStyle">solid</property>
                                <property name="borderLeftWidth">1px</property>
                                <property name="borderRightStyle">solid</property>
                                <property name="borderRightWidth">1px</property>
                            </extended-item>
                            <extended-item extensionName="CrosstabCell" id="1864">
                                <property name="borderLeftStyle">solid</property>
                                <property name="borderLeftWidth">1px</property>
                                <property name="borderRightStyle">solid</property>
                                <property name="borderRightWidth">1px</property>
                            </extended-item>
                        </property>
                        <property name="borderTopStyle">solid</property>
                        <property name="borderTopWidth">1px</property>
                        <property name="borderLeftStyle">solid</property>
                        <property name="borderLeftWidth">1px</property>
                        <property name="borderBottomStyle">solid</property>
                        <property name="borderBottomWidth">1px</property>
                        <property name="borderRightStyle">solid</property>
                        <property name="borderRightWidth">1px</property>
                        <list-property name="boundDataColumns">
                            <structure>
                                <property name="name">USERNAME</property>
                                <expression name="expression">dimension["Group2"]["USERNAME"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">SJ</property>
                                <expression name="expression">dimension["Group2"]["SJ"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">STATUSVAL1_Group2/SJ</property>
                                <expression name="expression">measure["STATUSVAL1"]</expression>
                                <property name="dataType">string</property>
                                <simple-property-list name="aggregateOn">
                                    <value>Group2/SJ</value>
                                </simple-property-list>
                                <property name="aggregateFunction">FIRST</property>
                            </structure>
                            <structure>
                                <property name="name">WORKDATE</property>
                                <expression name="expression">dimension["Group3"]["WORKDATE"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">STATUSVAL1_Group2/SJ_Group3/WORKDATE</property>
                                <expression name="expression">measure["STATUSVAL1"]</expression>
                                <property name="dataType">string</property>
                                <simple-property-list name="aggregateOn">
                                    <value>Group2/SJ</value>
                                    <value>Group3/WORKDATE</value>
                                </simple-property-list>
                                <property name="aggregateFunction">FIRST</property>
                            </structure>
                            <structure>
                                <property name="name">DHZ</property>
                                <expression name="expression">dimension["Group3"]["DHZ"]</expression>
                                <property name="dataType">string</property>
                            </structure>
                            <structure>
                                <property name="name">STATUSVAL1_Group2/SJ_Group3/DHZ</property>
                                <expression name="expression">measure["STATUSVAL1"]</expression>
                                <property name="dataType">string</property>
                                <simple-property-list name="aggregateOn">
                                    <value>Group2/SJ</value>
                                    <value>Group3/DHZ</value>
                                </simple-property-list>
                                <property name="aggregateFunction">FIRST</property>
                            </structure>
                        </list-property>
                    </extended-item>
                </cell>
            </row>
        </grid>
    </body>
</report>
